
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../task-kbuild/">
      
      
        <link rel="next" href="../../asg2/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Task 3: Experience the Boot Sequence - CS5250 Assignments (2025 Spring)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y4DCFEB3EM"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-Y4DCFEB3EM');
</script>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task-3-experience-the-boot-sequence" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CS5250 Assignments (2025 Spring)" class="md-header__button md-logo" aria-label="CS5250 Assignments (2025 Spring)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CS5250 Assignments (2025 Spring)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task 3: Experience the Boot Sequence
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/nus-cs5250/25s" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Assignment 1

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../asg2/" class="md-tabs__link">
          
  
  
    
  
  Assignment 2

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../asg3/" class="md-tabs__link">
          
  
  
    
  
  Assignment 3

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../asg4/" class="md-tabs__link">
          
  
  
    
  
  Assignment 4

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CS5250 Assignments (2025 Spring)" class="md-nav__button md-logo" aria-label="CS5250 Assignments (2025 Spring)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CS5250 Assignments (2025 Spring)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nus-cs5250/25s" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Assignment 1
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Assignment 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../task-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 1: Setup a Virtual Machine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../task-kbuild/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 2: Build and Install Linux Kernel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Task 3: Experience the Boot Sequence
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Task 3: Experience the Boot Sequence
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing-qemu" class="md-nav__link">
    <span class="md-ellipsis">
      Installing QEMU
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-seabios" class="md-nav__link">
    <span class="md-ellipsis">
      Building SeaBIOS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-linux-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      Building Linux Kernel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-an-initramfs" class="md-nav__link">
    <span class="md-ellipsis">
      Building an Initramfs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building an Initramfs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-simple-initramfs" class="md-nav__link">
    <span class="md-ellipsis">
      Create a simple initramfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-initramfs-using-busybox" class="md-nav__link">
    <span class="md-ellipsis">
      Create an initramfs using BusyBox
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#booting-into-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      Booting into Ubuntu
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Booting into Ubuntu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-a-hard-disk-image-for-the-ubuntu-root-filesystem" class="md-nav__link">
    <span class="md-ellipsis">
      Create a hard disk image for the Ubuntu root filesystem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch-to-rootfs-from-initramfs" class="md-nav__link">
    <span class="md-ellipsis">
      Switch to rootfs from initramfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-user" class="md-nav__link">
    <span class="md-ellipsis">
      Create a User
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../asg2/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Assignment 2
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Assignment 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-browsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optional: Get Around in the Source Code Tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-gdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 1: Debugging with GDB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 2: Developing a Kernel Module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg2/task-syscall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 3: Creating a New System Call
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../asg3/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Assignment 3
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Assignment 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg3/task-kprobe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 1: Hook System Calls with KProbes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg3/task-memhack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 2: Memory Manipulation in Tetris Game
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../asg4/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Assignment 4
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Assignment 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-cloudinit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 0: Cloud-Init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-pcidev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 1: PCI Device
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-chardev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 2: Character Device Driver and ioctl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../asg4/task-interrupt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Task 3: Interrupt handler
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="task-3-experience-the-boot-sequence">Task 3: Experience the Boot Sequence</h1>
<h2 id="installing-qemu">Installing QEMU</h2>
<p>QEMU is an open-source machine emulator that allows you to run virtual machines and emulate different architectures on your own system.
In this task, we will be leveraging the flexibility of QEMU, particularly its ability to specify a custom firmware or boot directly from a kernel image.</p>
<p>To install QEMU on your local machine, open your terminal and execute the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo apt install qemu-system-x86
</code></pre></div>
<p>After installing QEMU, you can start using it by running the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>qemu-system-x86_64 -nographic
</code></pre></div>
<p>Upon execution, you'll see some output starting with <code>SeaBIOS (version 1.xxx)</code>, followed by some boot attempts.
Since we are not providing any bootable image at this point, it's normal for the booting process to fail or hang.</p>
<p>You can quit QEMU by pressing <code>Ctrl-a</code> then <code>x</code>.
For more commands in this mode, please refer to the <a href="https://www.qemu.org/docs/master/system/mux-chardev.html">manual</a>.</p>
<h2 id="building-seabios">Building SeaBIOS</h2>
<p>SeaBIOS is an open-source implementation of x86 BIOS.</p>
<p>First, clone the SeaBIOS repository to get a copy of the source code.
You can do this by executing the following command in your terminal:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>git clone https://git.seabios.org/seabios.git
</code></pre></div>
<p>Navigate to the cloned repository and build SeaBIOS using the <code>make</code> command.</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>cd seabios &amp;&amp; make
</code></pre></div>
<p>This will generate a file named <code>bios.bin</code> in the <code>out</code> directory.
You can boot into SeaBIOS using the <code>bios.bin</code> file you just built. Run the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>qemu-system-x86_64 -nographic -bios out/bios.bin
</code></pre></div>
<p>Upon successful execution, the output should start with <code>SeaBIOS (version rel-1.16.3-xxxxx)</code>.
This version should be slightly different from the one you saw previously, indicating that you have successfully booted into the newly built SeaBIOS.</p>
<p>Please modify the source code so that your Matric No. (AxxxxxxxY) is printed out below the SeaBIOS version.</p>
<p>For submission, commit your changes using <code>git commit</code> and generate a patch file using <code>git format-patch</code>.
Please check the man pages for more information on these commands.
If you did this correctly, you should be able to apply your patch to a clean copy of the SeaBIOS source code using <code>git apply &lt;patch file&gt;</code>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Please submit the patch file that modifies the SeaBIOS source code to print your Matric No. below the SeaBIOS version.</p>
<p>Please note:</p>
<ul>
<li>You won't get any marks if the patch cannot be applied to a clean copy of SeaBIOS source code.</li>
<li>You won't get any marks if it fails to build after applying your patch.</li>
</ul>
</div>
<h2 id="building-linux-kernel">Building Linux Kernel</h2>
<p>You should have already built the kernel in the previous task.</p>
<h2 id="building-an-initramfs">Building an Initramfs</h2>
<h3 id="create-a-simple-initramfs">Create a simple initramfs</h3>
<p>Write a C program named <code>init.c</code> that prints out a message of your choice.
Be creative with your message.</p>
<div class="language-c highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">// Example of init.c</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello, World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="p">}</span>
</code></pre></div>
<p>Compile your program statically using the command below.
This will create an executable named <code>init</code>.</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>gcc -static -o init init.c
</code></pre></div>
<p>Create a new directory and move the <code>init</code> executable into it.
Ensure that the <code>init</code> executable is the only file in this directory.
Generate an initramfs from the directory containing your <code>init</code> executable using the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>find . | cpio -H newc -o | gzip &gt; ../initramfs.cpio.gz
</code></pre></div>
<p>Boot into the kernel using your newly created initramfs by executing the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>qemu-system-x86_64 -nographic -append &quot;console=ttyS0&quot; -kernel /path/to/bzImage -initrd /path/to/initramfs.cpio.gz
</code></pre></div>
<p>Replace <code>/path/to/bzImage</code> and <code>/path/to/initramfs.cpio.gz</code> with the actual paths to your kernel image and initramfs respectively.</p>
<p>You will encounter a kernel panic.
But don't panic!
Look for the lines <code>Run /init as init process</code> and <code>Kernel panic - not syncing: Attempted to kill init!</code>.
Your message should appear between these two lines.
If you see your message, you've successfully built and booted an initramfs.</p>
<h3 id="create-an-initramfs-using-busybox">Create an initramfs using BusyBox</h3>
<p>Start by downloading the latest stable version of the BusyBox source code from the official website: <a href="https://busybox.net/">BusyBox</a>.
After downloading, extract the source code and navigate to the directory containing the extracted source code.</p>
<p>Next, create a configuration using the <code>make menuconfig</code> command.
During this process, ensure that you</p>
<ul>
<li>Enable the "Build static binary (no shared libs)" option under "Settings".</li>
<li>Disable the "TC" option under "Networking Utilities".</li>
</ul>
<p>Then, build the source code using <code>make</code> command.</p>
<p>After building the source code, install BusyBox using the <code>make install</code> command.
This will install BusyBox to the <code>_install</code> directory.</p>
<p>You'll notice that most of the executable files under the <code>_install/bin</code> directory are merely links to the <code>busybox</code> executable.
Interestingly, despite being links, each of these files can be executed and behaves differently.
Try to understand how this functionality is achieved and explain the underlying concept with a brief code snippet.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>To demonstrate your understanding, you are required to write a C program.
This program should be compiled into an executable named <code>dispatch</code>.
When a link (with different names) to <code>dispatch</code> is executed, it should output different messages based on the filename of the link.</p>
<p>Here are the expected outputs for different filenames:</p>
<table>
<thead>
<tr>
<th>Filename</th>
<th>Expected Output</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hello</code></td>
<td>Prints <code>Hello World!</code></td>
</tr>
<tr>
<td><code>user</code></td>
<td>Prints the current username</td>
</tr>
<tr>
<td><code>kernel</code></td>
<td>Prints the kernel release version of the current system (e.g., <code>6.7.0-14-generic</code>)</td>
</tr>
</tbody>
</table>
<p>Here's an example of how the program should behave:</p>
<p><a href="https://asciinema.org/a/b3OtOhNR595XeR1FYPIMP35O5"><img alt="asciicast" src="https://asciinema.org/a/b3OtOhNR595XeR1FYPIMP35O5.svg" /></a></p>
</div>
<p>Next, create an <code>init</code> script in the <code>_install</code> directory.
This script will directly drop to a shell.
Here's a sample script, remember to replace <code>&lt;your name&gt;</code> and <code>&lt;your Matric No.&gt;</code> with your actual name and Matric No.:</p>
<div class="language-bash highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="ch">#!/bin/sh</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nb">set</span><span class="w"> </span>-ex
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hello, &lt;your name&gt; (&lt;your Matric No.&gt;)&quot;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nb">exec</span><span class="w"> </span>/bin/sh
</code></pre></div>
<p>The <code>set -ex</code> command facilitates debugging by printing each command before executing it and exiting immediately if any command fails.
Remember to make the script executable using the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>chmod +x init
</code></pre></div>
<p>Finally, pack all the files in the <code>_install</code> directory into an initramfs using the command used previously.
You may use QEMU to test if it works.</p>
<h2 id="booting-into-ubuntu">Booting into Ubuntu</h2>
<h3 id="create-a-hard-disk-image-for-the-ubuntu-root-filesystem">Create a hard disk image for the Ubuntu root filesystem</h3>
<p>Download the Ubuntu 24.04 minimal cloud image from the following link:
<a href="https://cloud-images.ubuntu.com/minimal/releases/noble/release/ubuntu-24.04-minimal-cloudimg-amd64-root.tar.xz">Ubuntu 24.04 minimal cloud image</a></p>
<p>We will be creating a hard disk image using the downloaded files.
First, create a file that is large enough to hold the root filesystem.
In this example, we will create a 16 GiB file and format it as an ext4 filesystem using the following commands:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>fallocate -l 16GiB rootfs.img
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>mkfs.ext4 rootfs.img
</code></pre></div>
<p>Next, mount the image at a temporary location, extract the root filesystem into it, and then unmount it.
You can do this using the following commands:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>mkdir rootfs
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>sudo mount -o loop ./rootfs.img ./rootfs
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>sudo tar xf ubuntu-24.04-minimal-cloudimg-amd64-root.tar.xz -C rootfs
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>sudo umount rootfs
</code></pre></div>
<p>At this point, the <code>rootfs.img</code> file is a hard disk image that is ready to be used as a root filesystem.</p>
<h3 id="switch-to-rootfs-from-initramfs">Switch to rootfs from initramfs</h3>
<p>BusyBox provides a <code>switch_root</code> command that can be used to switch to a new root filesystem.
You will need to find out how to use this command and modify the <code>init</code> script accordingly to switch to the root filesystem.</p>
<p>You can then boot into the root filesystem using the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>qemu-system-x86_64 -nographic -kernel bzImage -initrd busybox.cpio.gz -append &#39;console=ttyS0&#39; rootfs.img
</code></pre></div>
<p>Hints:</p>
<ul>
<li>The <code>rootfs.img</code> is equivalent to a hard disk in the virtual machine launched by QEMU.</li>
<li>You will need to have "proc" and "devtmpfs" mounted in the init script.</li>
</ul>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Please submit the initramfs image <code>initramfs.cpio.gz</code> which can switch to the root filesystem.</p>
</div>
<h3 id="create-a-user">Create a User</h3>
<p>The root filesystem that we created does not have any users, which means you cannot log in to it.
To create a user, we will boot into the system in single-user mode (rescue mode) and use the <code>useradd</code> command.</p>
<p>To boot into rescue mode, add <code>systemd.unit=rescue.target</code> to the kernel command line using the following command:</p>
<div class="language-text highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>qemu-system-x86_64 -nographic -kernel bzImage -initrd busybox.cpio.gz -append &#39;console=ttyS0 systemd.unit=rescue.target&#39; rootfs.img
</code></pre></div>
<p>Once in rescue mode, you can create a user using the <code>useradd</code> command.
Please search online for instructions on how to use this command to create a user.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Which component acts upon the <code>systemd.unit=rescue.target</code> argument?
Is it consumed by the (a) BIOS, (b) kernel, (c) initramfs, or (d) after switching to the root filesystem?</p>
<p>Please choose ONE of the options above first and then provide a brief explanation.</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.indexes", "navigation.sections", "navigation.tabs", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../javascripts/open_in_new_tab.js"></script>
      
    
  </body>
</html>